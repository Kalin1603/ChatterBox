<!--
  Refactored Sidebar
  - Softer glassmorphism background
  - Refined hover/active states without adding new sections
-->
<div id="site__sidebar" class="fixed top-0 left-0 z-[99] pt-[--m-top] overflow-hidden transition-transform duration-300 ease-in-out max-xl:-translate-x-full">

    <!-- Sidebar Panel -->
    <div class="2xl:w-72 sm:w-64 w-72 h-[calc(100vh-var(--m-top))] relative z-30
                max-xl:bg-white/80 max-xl:dark:bg-slate-800/80 max-xl:backdrop-blur-xl">

        <div class="p-4 h-full" data-simplebar>
            <nav id="side">
                <ul class="space-y-1">
                    <li>
                        <a asp-controller="Home" asp-action="Index">
                            <img src="~/images/icons/home.png" class="w-6" />
                            <span>Feed</span>
                        </a>
                    </li>
                    <li>
                        <a asp-controller="Favorites" asp-action="Index">
                            <img src="~/images/icons/page.png" class="w-6" />
                            <span>Favorites</span>
                        </a>
                    </li>
                    <!-- The separator is now a border on the list item -->
                    <li class="pb-3 pt-2 border-b border-slate-200/80 dark:border-slate-700/80">
                        <a asp-controller="Profile" asp-action="SuggestedFriends">
                            <img src="~/images/icons/group-2.png" class="w-6" />
                            <span>Friends</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <!-- Overlay for Mobile -->
    <div id="site__sidebar__overly"
         class="absolute top-0 left-0 z-20 w-screen h-screen xl:hidden bg-black/20 backdrop-blur-sm transition-opacity"
         uk-toggle="target: #site__sidebar ; cls :!-translate-x-0"></div>
</div>

<!-- Self-contained script for active link highlighting -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Ensure this script doesn't run again if it's already been loaded
        if (window.sidebarScriptLoaded) return;
        window.sidebarScriptLoaded = true;

        const currentPath = window.location.pathname.toLowerCase();
        const navLinks = document.querySelectorAll('#side a');

        navLinks.forEach(link => {
            const linkPath = link.getAttribute('href').toLowerCase();
            // Simple check for exact match
            if (linkPath === currentPath) {
                link.classList.add('active');
            }
        });
    });
</script>